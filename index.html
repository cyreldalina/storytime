<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cyrel Dalina | Storyteller</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-tertiary: #1e1e2e;
            --text-primary: #f0f0f5;
            --text-secondary: #8b8b9a;
            --accent: #6366f1;
            --accent-hover: #818cf8;
            --border: #2a2a3a;
            --success: #22c55e;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Navigation - Clean with Profile */
        .navbar {
            background: rgba(10, 10, 15, 0.98);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            padding: 12px 16px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }

        .nav-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 4px;
            border-radius: 50px;
            transition: background 0.3s;
        }

        .nav-profile:hover {
            background: var(--bg-tertiary);
        }

        .nav-profile-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--accent);
            display: none;
        }

        .nav-profile-img.visible {
            display: block;
        }

        .nav-profile-placeholder {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            border: 2px solid var(--border);
        }

        .nav-profile-placeholder.hidden {
            display: none;
        }

        .nav-profile-info {
            display: flex;
            flex-direction: column;
        }

        .nav-profile-name {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text-primary);
        }

        .nav-profile-tagline {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .nav-links {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .nav-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 8px 14px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .nav-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .nav-btn.primary {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .nav-btn.primary:hover {
            background: var(--accent-hover);
        }

        /* Profile Modal (Replaces old hero section) */
        .profile-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: flex-start;
            padding-top: 80px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .profile-modal.active {
            display: flex;
        }

        .profile-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            overflow: hidden;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .profile-header {
            position: relative;
            padding: 40px 24px 24px;
            text-align: center;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
        }

        .close-profile {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(0,0,0,0.5);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }

        .close-profile:hover {
            background: var(--accent);
        }

        .profile-card-img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--accent);
            margin-bottom: 16px;
            display: none;
        }

        .profile-card-img.visible {
            display: block;
        }

        .profile-card-placeholder {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            border: 4px solid var(--border);
            margin: 0 auto 16px;
        }

        .profile-card-placeholder.hidden {
            display: none;
        }

        .profile-card-name {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .profile-card-tagline {
            color: var(--accent);
            font-size: 1rem;
            margin-bottom: 16px;
        }

        .profile-card-bio {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.7;
            padding: 0 24px 24px;
            text-align: center;
        }

        .profile-stats-row {
            display: flex;
            justify-content: center;
            gap: 40px;
            padding: 20px 24px;
            border-top: 1px solid var(--border);
        }

        .profile-stat {
            text-align: center;
        }

        .profile-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .profile-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Main Content */
        .main-content {
            padding: 80px 16px 40px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Section Header */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        /* Stories Grid */
        .stories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .story-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
        }

        .story-card:hover {
            transform: translateY(-4px);
            border-color: var(--accent);
            box-shadow: 0 10px 40px rgba(99, 102, 241, 0.1);
        }

        .story-cover {
            width: 100%;
            height: 180px;
            object-fit: cover;
            background: var(--bg-tertiary);
            display: none;
        }

        .story-cover.visible {
            display: block;
        }

        .story-cover-placeholder {
            width: 100%;
            height: 180px;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: var(--text-secondary);
        }

        .story-card-content {
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .story-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .story-card-excerpt {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 14px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            word-wrap: break-word;
        }

        .story-card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: auto;
        }

        /* Story Reader Modal */
        .reader-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 3000;
            display: none;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .reader-modal.active {
            display: block;
        }

        .reader-header {
            position: sticky;
            top: 0;
            background: rgba(10, 10, 15, 0.98);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }

        .reader-title {
            font-size: 1rem;
            font-weight: 600;
        }

        .close-reader {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .reader-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 24px 16px 60px;
        }

        .reader-cover {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 24px;
            display: none;
        }

        .reader-cover.visible {
            display: block;
        }

        .reader-story-title {
            font-size: 1.75rem;
            margin-bottom: 12px;
            line-height: 1.3;
            word-wrap: break-word;
        }

        .reader-meta {
            color: var(--text-secondary);
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
            font-size: 0.9rem;
        }

        .reader-body {
            font-size: 1.05rem;
            line-height: 1.8;
            color: var(--text-primary);
            font-family: Georgia, 'Times New Roman', serif;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        /* Admin Panel */
        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 4000;
            flex-direction: column;
        }

        .admin-panel.active {
            display: flex;
        }

        .admin-sidebar {
            width: 100%;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            flex-shrink: 0;
        }

        .admin-header {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border);
        }

        .admin-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .admin-subtitle {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .admin-menu {
            display: flex;
            padding: 8px;
            gap: 8px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .admin-menu-item {
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .admin-menu-item:hover, .admin-menu-item.active {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .admin-menu-item.active {
            background: var(--accent);
            color: white;
        }

        .admin-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            -webkit-overflow-scrolling: touch;
        }

        .admin-section {
            display: none;
            max-width: 100%;
        }

        .admin-section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 12px 14px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .form-textarea {
            min-height: 300px;
            font-family: Georgia, 'Times New Roman', serif;
            line-height: 1.7;
            resize: vertical;
        }

        .btn {
            padding: 12px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .stories-list-admin {
            margin-top: 20px;
        }

        .admin-story-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
        }

        .admin-story-info {
            flex: 1;
            min-width: 0;
        }

        .admin-story-info h4 {
            margin-bottom: 4px;
            font-size: 1rem;
            word-wrap: break-word;
        }

        .admin-story-date {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .admin-story-actions {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        .icon-btn-sm {
            width: 36px;
            height: 36px;
            border-radius: 6px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .icon-btn-sm:hover {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        .icon-btn-sm.delete:hover {
            background: #ef4444;
            border-color: #ef4444;
        }

        /* Image Upload */
        .image-upload-box {
            position: relative;
            width: 100%;
            max-width: 200px;
            aspect-ratio: 1;
            border-radius: 12px;
            overflow: hidden;
            background: var(--bg-tertiary);
            border: 2px dashed var(--border);
            cursor: pointer;
        }

        .image-upload-box.has-image {
            border-style: solid;
            border-color: var(--accent);
        }

        .image-upload-box input[type="file"] {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .upload-preview {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        .upload-preview.visible {
            display: block;
        }

        .upload-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            gap: 8px;
            padding: 16px;
        }

        .upload-placeholder.hidden {
            display: none;
        }

        .upload-icon {
            font-size: 2rem;
        }

        .upload-text {
            font-size: 0.8rem;
            text-align: center;
        }

        .upload-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.8);
            padding: 8px;
            text-align: center;
            font-size: 0.75rem;
            color: white;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .image-upload-box:hover .upload-overlay {
            opacity: 1;
        }

        .cover-upload-box {
            max-width: 100%;
            aspect-ratio: 16/9;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            padding: 12px 24px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.3s;
            z-index: 5000;
            font-size: 0.9rem;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
        }

        .toast.success {
            border-color: var(--success);
        }

        /* Mobile */
        @media (max-width: 768px) {
            .navbar {
                padding: 10px 12px;
            }

            .nav-profile-name {
                font-size: 0.9rem;
            }

            .nav-profile-tagline {
                display: none;
            }

            .nav-btn {
                padding: 6px 12px;
                font-size: 0.75rem;
            }

            .main-content {
                padding: 72px 12px 24px;
            }

            .stories-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .story-cover, .story-cover-placeholder {
                height: 160px;
            }

            .profile-card {
                width: 95%;
                margin: 0 12px;
            }

            .profile-card-img, .profile-card-placeholder {
                width: 100px;
                height: 100px;
            }
        }

        @media (max-width: 380px) {
            .nav-profile-info {
                display: none;
            }
        }

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <!-- Navigation with Profile -->
    <nav class="navbar">
        <div class="nav-profile" onclick="showProfileModal()">
            <img class="nav-profile-img" id="navProfileImg" alt="Profile">
            <div class="nav-profile-placeholder" id="navProfilePlaceholder">üë§</div>
            <div class="nav-profile-info">
                <span class="nav-profile-name" id="navProfileName">Cyrel Dalina</span>
                <span class="nav-profile-tagline" id="navProfileTagline">Writer & Storyteller</span>
            </div>
        </div>
        <div class="nav-links">
            <button class="nav-btn" onclick="showLogin()">‚úé Write</button>
        </div>
    </nav>

    <!-- Profile Modal (Popup) -->
    <div class="profile-modal" id="profileModal">
        <div class="profile-card">
            <div class="profile-header">
                <button class="close-profile" onclick="closeProfileModal()">√ó</button>
                <img class="profile-card-img" id="profileCardImg" alt="Profile">
                <div class="profile-card-placeholder" id="profileCardPlaceholder">üë§</div>
                <div class="profile-card-name" id="profileCardName">Cyrel Dalina</div>
                <div class="profile-card-tagline" id="profileCardTagline">Writer & Storyteller</div>
            </div>
            <div class="profile-card-bio" id="profileCardBio">
                Welcome to my digital library. Here I share stories that matter‚Äîtales of life, imagination, and everything in between.
            </div>
            <div class="profile-stats-row">
                <div class="profile-stat">
                    <div class="profile-stat-value" id="profileStatStories">0</div>
                    <div class="profile-stat-label">Stories</div>
                </div>
                <div class="profile-stat">
                    <div class="profile-stat-value">1.2k</div>
                    <div class="profile-stat-label">Readers</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="section-header">
            <h1 class="section-title">
                <span>üìö</span>
                <span>Latest Stories</span>
            </h1>
        </div>

        <div class="stories-grid" id="storiesGrid">
            <div class="empty-state">
                <div class="empty-state-icon">üìù</div>
                <h3>No stories yet</h3>
                <p>Check back soon for new content!</p>
            </div>
        </div>
    </main>

    <!-- Story Reader -->
    <div class="reader-modal" id="readerModal">
        <div class="reader-header">
            <div class="reader-title">Reading Mode</div>
            <button class="close-reader" onclick="closeReader()">√ó</button>
        </div>
        <article class="reader-content">
            <img class="reader-cover" id="readerCover" alt="Cover">
            <h1 class="reader-story-title" id="readerTitle"></h1>
            <div class="reader-meta" id="readerMeta"></div>
            <div class="reader-body" id="readerBody"></div>
        </article>
    </div>

    <!-- Login Modal -->
    <div class="profile-modal" id="loginModal" style="z-index: 3500;">
        <div class="profile-card" style="max-width: 360px;">
            <div class="profile-header" style="padding-top: 32px;">
                <button class="close-profile" onclick="closeLogin()">√ó</button>
                <div style="font-size: 3rem; margin-bottom: 16px;">üîê</div>
                <div class="profile-card-name">Author Login</div>
                <div class="profile-card-tagline">Enter password to continue</div>
            </div>
            <div style="padding: 0 24px 24px;">
                <input type="password" class="form-input" id="passwordInput" placeholder="Enter password" style="text-align: center; margin-bottom: 16px;" onkeypress="if(event.key==='Enter')checkPassword()">
                <button class="btn btn-primary" onclick="checkPassword()">Unlock</button>
                <button class="btn btn-secondary" onclick="closeLogin()" style="margin-top: 12px;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-sidebar">
            <div class="admin-header">
                <div class="admin-title">Author Dashboard</div>
                <div class="admin-subtitle">Manage your content</div>
            </div>
            <div class="admin-menu">
                <div class="admin-menu-item active" onclick="showAdminSection('stories')">
                    <span>üìù</span> Stories
                </div>
                <div class="admin-menu-item" onclick="showAdminSection('profile')">
                    <span>üë§</span> Profile
                </div>
                <div class="admin-menu-item" onclick="logout()">
                    <span>üö™</span> Exit
                </div>
            </div>
        </div>
        <div class="admin-content">
            <!-- Stories Management -->
            <div class="admin-section active" id="adminStories">
                <h2 style="margin-bottom: 20px; font-size: 1.3rem;">My Stories</h2>
                <button class="btn btn-primary" onclick="createNewStory()">
                    <span>+</span> New Story
                </button>
                <div class="stories-list-admin" id="adminStoriesList"></div>
            </div>

            <!-- Profile Editor -->
            <div class="admin-section" id="adminProfile">
                <h2 style="margin-bottom: 20px; font-size: 1.3rem;">Edit Profile</h2>

                <div class="form-group">
                    <label class="form-label">Profile Photo</label>
                    <div class="image-upload-box" id="profileUploadBox">
                        <img class="upload-preview" id="profileUploadPreview" alt="Preview">
                        <div class="upload-placeholder" id="profileUploadPlaceholder">
                            <span class="upload-icon">üì∑</span>
                            <span class="upload-text">Click to upload</span>
                        </div>
                        <div class="upload-overlay">Change photo</div>
                        <input type="file" accept="image/*" onchange="handleProfileImageUpload(event)">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Name</label>
                    <input type="text" class="form-input" id="adminAuthorName" value="Cyrel Dalina">
                </div>

                <div class="form-group">
                    <label class="form-label">Tagline</label>
                    <input type="text" class="form-input" id="adminAuthorTagline" value="Writer & Storyteller">
                </div>

                <div class="form-group">
                    <label class="form-label">Bio</label>
                    <textarea class="form-textarea" id="adminAuthorBio" rows="4">Welcome to my digital library. Here I share stories that matter.</textarea>
                </div>

                <button class="btn btn-primary" onclick="saveProfile()">Save Profile</button>
            </div>

            <!-- Story Editor -->
            <div class="admin-section" id="adminEditor">
                <div style="margin-bottom: 20px;">
                    <h2 style="font-size: 1.3rem; margin-bottom: 16px;">Write Story</h2>
                    <div style="display: flex; gap: 12px;">
                        <button class="btn btn-secondary" onclick="cancelEdit()">Cancel</button>
                        <button class="btn btn-primary" onclick="saveStory()">Publish</button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Cover Image (Optional)</label>
                    <div class="image-upload-box cover-upload-box" id="coverUploadBox">
                        <img class="upload-preview" id="coverUploadPreview" alt="Cover">
                        <div class="upload-placeholder" id="coverUploadPlaceholder">
                            <span class="upload-icon">üñºÔ∏è</span>
                            <span class="upload-text">Add cover</span>
                        </div>
                        <div class="upload-overlay">Change cover</div>
                        <input type="file" accept="image/*" onchange="handleCoverUpload(event)">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Title *</label>
                    <input type="text" class="form-input" id="editTitle" placeholder="Story title...">
                </div>

                <div class="form-group">
                    <label class="form-label">Content *</label>
                    <textarea class="form-textarea" id="editContent" placeholder="Write your story here..."></textarea>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <span id="toastIcon">‚úì</span>
        <span id="toastMessage">Saved!</span>
    </div>

    <script>
        const ADMIN_PASSWORD = 'cyrel123';
        let stories = [];
        let profile = {
            name: 'Cyrel Dalina',
            tagline: 'Writer & Storyteller',
            bio: 'Welcome to my digital library. Here I share stories that matter.',
            image: null
        };
        let currentEditId = null;
        let tempCoverImage = null;

        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            updateNavProfile();
            renderStories();
        });

        function loadData() {
            try {
                const savedStories = localStorage.getItem('cd_stories');
                const savedProfile = localStorage.getItem('cd_profile');
                if (savedStories) stories = JSON.parse(savedStories);
                if (savedProfile) profile = JSON.parse(savedProfile);
            } catch (e) {
                console.error('Error loading data:', e);
            }
        }

        function saveData() {
            try {
                localStorage.setItem('cd_stories', JSON.stringify(stories));
                localStorage.setItem('cd_profile', JSON.stringify(profile));
            } catch (e) {
                showToast('Error saving data', 'error');
            }
        }

        // Navigation Profile
        function updateNavProfile() {
            document.getElementById('navProfileName').textContent = profile.name;
            document.getElementById('navProfileTagline').textContent = profile.tagline;

            const img = document.getElementById('navProfileImg');
            const placeholder = document.getElementById('navProfilePlaceholder');

            if (profile.image) {
                img.src = profile.image;
                img.classList.add('visible');
                placeholder.classList.add('hidden');
            } else {
                img.classList.remove('visible');
                placeholder.classList.remove('hidden');
            }
        }

        // Profile Modal
        function showProfileModal() {
            document.getElementById('profileCardName').textContent = profile.name;
            document.getElementById('profileCardTagline').textContent = profile.tagline;
            document.getElementById('profileCardBio').textContent = profile.bio;
            document.getElementById('profileStatStories').textContent = stories.length;

            const img = document.getElementById('profileCardImg');
            const placeholder = document.getElementById('profileCardPlaceholder');

            if (profile.image) {
                img.src = profile.image;
                img.classList.add('visible');
                placeholder.classList.add('hidden');
            } else {
                img.classList.remove('visible');
                placeholder.classList.remove('hidden');
            }

            document.getElementById('profileModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeProfileModal() {
            document.getElementById('profileModal').classList.remove('active');
            document.body.style.overflow = '';
        }

        // Stories
        function renderStories() {
            const grid = document.getElementById('storiesGrid');

            if (stories.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìù</div>
                        <h3>No stories yet</h3>
                        <p>Check back soon!</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = stories.map(story => `
                <div class="story-card" onclick="openReader('${story.id}')">
                    ${story.cover ? 
                        `<img src="${story.cover}" class="story-cover visible" alt="Cover">` : 
                        `<div class="story-cover-placeholder">üìñ</div>`
                    }
                    <div class="story-card-content">
                        <h3 class="story-card-title">${escapeHtml(story.title)}</h3>
                        <p class="story-card-excerpt">${escapeHtml(story.content.substring(0, 150))}...</p>
                        <div class="story-card-meta">
                            <span>${formatDate(story.date)}</span>
                            <span>‚è± ${estimateReadTime(story.content)}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function openReader(id) {
            const story = stories.find(s => s.id === id);
            if (story) {
                document.getElementById('readerTitle').textContent = story.title;
                document.getElementById('readerMeta').innerHTML = `
                    By ${profile.name} ‚Ä¢ ${formatDate(story.date)} ‚Ä¢ ${estimateReadTime(story.content)} read
                `;
                document.getElementById('readerBody').textContent = story.content;

                const cover = document.getElementById('readerCover');
                if (story.cover) {
                    cover.src = story.cover;
                    cover.classList.add('visible');
                } else {
                    cover.classList.remove('visible');
                }

                document.getElementById('readerModal').classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeReader() {
            document.getElementById('readerModal').classList.remove('active');
            document.body.style.overflow = '';
        }

        // Image Uploads
        function handleProfileImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            if (file.size > 2 * 1024 * 1024) {
                showToast('Image too large (max 2MB)', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const size = 400;

                    let w = img.width, h = img.height;
                    if (w > h) { h = h * size / w; w = size; }
                    else { w = w * size / h; h = size; }

                    canvas.width = w;
                    canvas.height = h;
                    ctx.drawImage(img, 0, 0, w, h);

                    profile.image = canvas.toDataURL('image/jpeg', 0.8);

                    document.getElementById('profileUploadPreview').src = profile.image;
                    document.getElementById('profileUploadPreview').classList.add('visible');
                    document.getElementById('profileUploadPlaceholder').classList.add('hidden');
                    document.getElementById('profileUploadBox').classList.add('has-image');

                    showToast('Photo uploaded!', 'success');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function handleCoverUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            if (file.size > 2 * 1024 * 1024) {
                showToast('Image too large (max 2MB)', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    const maxW = 800, maxH = 400;

                    let w = img.width, h = img.height;
                    if (w > maxW) { h = h * maxW / w; w = maxW; }
                    if (h > maxH) { w = w * maxH / h; h = maxH; }

                    canvas.width = w;
                    canvas.height = h;
                    ctx.drawImage(img, 0, 0, w, h);

                    tempCoverImage = canvas.toDataURL('image/jpeg', 0.8);

                    document.getElementById('coverUploadPreview').src = tempCoverImage;
                    document.getElementById('coverUploadPreview').classList.add('visible');
                    document.getElementById('coverUploadPlaceholder').classList.add('hidden');
                    document.getElementById('coverUploadBox').classList.add('has-image');

                    showToast('Cover uploaded!', 'success');
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // Admin
        function showLogin() {
            document.getElementById('loginModal').classList.add('active');
            setTimeout(() => document.getElementById('passwordInput').focus(), 100);
        }

        function closeLogin() {
            document.getElementById('loginModal').classList.remove('active');
            document.getElementById('passwordInput').value = '';
        }

        function checkPassword() {
            if (document.getElementById('passwordInput').value === ADMIN_PASSWORD) {
                closeLogin();
                document.getElementById('adminPanel').classList.add('active');
                renderAdminStories();
                loadProfileForEdit();
            } else {
                showToast('Wrong password', 'error');
                document.getElementById('passwordInput').value = '';
            }
        }

        function logout() {
            document.getElementById('adminPanel').classList.remove('active');
        }

        function renderAdminStories() {
            const list = document.getElementById('adminStoriesList');
            if (stories.length === 0) {
                list.innerHTML = '<p style="color: var(--text-secondary); margin-top: 20px;">No stories yet.</p>';
                return;
            }
            list.innerHTML = stories.map(story => `
                <div class="admin-story-item">
                    <div class="admin-story-info">
                        <h4>${escapeHtml(story.title)}</h4>
                        <div class="admin-story-date">${formatDate(story.date)} ‚Ä¢ ${estimateReadTime(story.content)}</div>
                    </div>
                    <div class="admin-story-actions">
                        <button class="icon-btn-sm" onclick="editStory('${story.id}')">‚úé</button>
                        <button class="icon-btn-sm delete" onclick="deleteStory('${story.id}')">üóë</button>
                    </div>
                </div>
            `).join('');
        }

        function createNewStory() {
            currentEditId = null;
            tempCoverImage = null;
            document.getElementById('editTitle').value = '';
            document.getElementById('editContent').value = '';
            document.getElementById('coverUploadPreview').classList.remove('visible');
            document.getElementById('coverUploadPlaceholder').classList.remove('hidden');
            document.getElementById('coverUploadBox').classList.remove('has-image');
            showAdminSection('editor');
        }

        function editStory(id) {
            const story = stories.find(s => s.id === id);
            if (story) {
                currentEditId = id;
                tempCoverImage = story.cover || null;
                document.getElementById('editTitle').value = story.title;
                document.getElementById('editContent').value = story.content;

                if (story.cover) {
                    document.getElementById('coverUploadPreview').src = story.cover;
                    document.getElementById('coverUploadPreview').classList.add('visible');
                    document.getElementById('coverUploadPlaceholder').classList.add('hidden');
                    document.getElementById('coverUploadBox').classList.add('has-image');
                } else {
                    document.getElementById('coverUploadPreview').classList.remove('visible');
                    document.getElementById('coverUploadPlaceholder').classList.remove('hidden');
                    document.getElementById('coverUploadBox').classList.remove('has-image');
                }
                showAdminSection('editor');
            }
        }

        function saveStory() {
            const title = document.getElementById('editTitle').value.trim();
            const content = document.getElementById('editContent').value.trim();
            if (!title || !content) {
                showToast('Fill in title and content', 'error');
                return;
            }

            if (currentEditId) {
                const story = stories.find(s => s.id === currentEditId);
                story.title = title;
                story.content = content;
                story.cover = tempCoverImage || story.cover;
                story.date = new Date().toISOString();
            } else {
                stories.unshift({
                    id: Date.now().toString(),
                    title, content,
                    cover: tempCoverImage,
                    date: new Date().toISOString()
                });
            }

            saveData();
            updateNavProfile();
            renderStories();
            renderAdminStories();
            showAdminSection('stories');
            showToast('Story published!', 'success');
        }

        function deleteStory(id) {
            if (confirm('Delete this story?')) {
                stories = stories.filter(s => s.id !== id);
                saveData();
                renderStories();
                renderAdminStories();
                showToast('Story deleted', 'success');
            }
        }

        function cancelEdit() {
            tempCoverImage = null;
            showAdminSection('stories');
        }

        function loadProfileForEdit() {
            document.getElementById('adminAuthorName').value = profile.name;
            document.getElementById('adminAuthorTagline').value = profile.tagline;
            document.getElementById('adminAuthorBio').value = profile.bio;

            if (profile.image) {
                document.getElementById('profileUploadPreview').src = profile.image;
                document.getElementById('profileUploadPreview').classList.add('visible');
                document.getElementById('profileUploadPlaceholder').classList.add('hidden');
                document.getElementById('profileUploadBox').classList.add('has-image');
            } else {
                document.getElementById('profileUploadPreview').classList.remove('visible');
                document.getElementById('profileUploadPlaceholder').classList.remove('hidden');
                document.getElementById('profileUploadBox').classList.remove('has-image');
            }
        }

        function saveProfile() {
            profile.name = document.getElementById('adminAuthorName').value || 'Cyrel Dalina';
            profile.tagline = document.getElementById('adminAuthorTagline').value || 'Writer';
            profile.bio = document.getElementById('adminAuthorBio').value || '';

            saveData();
            updateNavProfile();
            showToast('Profile saved!', 'success');
        }

        function showAdminSection(section) {
            document.querySelectorAll('.admin-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.admin-menu-item').forEach(el => el.classList.remove('active'));

            if (section === 'stories') {
                document.getElementById('adminStories').classList.add('active');
                document.querySelectorAll('.admin-menu-item')[0].classList.add('active');
            } else if (section === 'profile') {
                document.getElementById('adminProfile').classList.add('active');
                document.querySelectorAll('.admin-menu-item')[1].classList.add('active');
            } else if (section === 'editor') {
                document.getElementById('adminEditor').classList.add('active');
            }
        }

        // Utilities
        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-US', { 
                year: 'numeric', month: 'short', day: 'numeric' 
            });
        }

        function estimateReadTime(content) {
            return Math.ceil(content.split(/\s+/).length / 200) + ' min';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            document.getElementById('toastIcon').textContent = type === 'success' ? '‚úì' : '‚ö†';
            toast.className = 'toast show ' + type;
            setTimeout(() => toast.classList.remove('show'), 2500);
        }

        // Event Listeners
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeProfileModal();
                closeReader();
                closeLogin();
            }
        });

        document.getElementById('profileModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('profileModal')) closeProfileModal();
        });

        document.getElementById('readerModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('readerModal')) closeReader();
        });
    </script>
</body>
</html>